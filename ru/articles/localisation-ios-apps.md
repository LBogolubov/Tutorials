В этом туториале расскажем все о локализации iOS приложений, как она работает и какие инструменты могут помочь в работе с ней. 

## Введение

Локализация iOS приложения подразумевает собой не только перевод на рызные языки через ключи, ведь многие требуют индивидуального подхода. Например иногда нужно локализовать изображение или изменить размер шрифта для определенного языка. Этот туториал ориентирован как на начинающих разработчиков, которые впервые столкнулись с локализацией, так и для опытных, которым мы покажем тру-вей по работе с ней. Начнем.

### Как устроена локализация

Для того, что бы локализовать основной текст в приложении нам понадобится `NSLocalizedString` - макрос, который возвращает локализованную строку и имеет 2 аргумента: ключ и комментарий. 

```swift
	let localisedString = NSLocalizedString(
		"label text", // Уникальный ключ, по которому мы поймем какую строку локализуем
		comment: "Макисмум 2 слова" // Комментарий, в котором можно уточнить информацию для переводчика (можно оставить пустым)
	)
```

> Каждый ключ должен быть уникальным для того что бы избежать ошибок в локализации. Ничего страшного не произойдет и программа скомпилируется, но может вернуться неправильное значение.

Такой макрос попадёт в файл `Localizable.strings`, который автоматически создаст XCode после экспорта и импорта локализаций в формате "ключ" = "значение":

```swift
/* Макисмум 2 слова */
"label text" = "Localised text";
```

Теперь при запросе ключа "label text" в коде нам вернется локализованное значение, в нашем случае "Localised text". Если использовать в коде не локализованный ключ - на месте текста отобразится он сам.

### InfoPlist

`InfoPlist` - ресурс, содержащий ключ-пары для идентификации и конфигурации бандла.

Здесь нас интересует то, что все эти значения тоже можно и нужно локализовать. Например название приложения автоматически появится в `xloc` файле после экспорта и его можно будет перевести. После импорта появится в файле `InfoPlist.strings`, который так же автоматически создаст XCode. 

Точно так же появятся локализационные ключи разрешений, которые вы добавите в свое приложение. Например можно перевести для чего вам нужен доступ к камере на разные языки.

### Передача параметров в локализационный ключ

В `NSLocalizedString` можно передавать параметры при помощи спецификатора формата `String`, например:

```swift
	let parametrString = "Empty" // Текст, который хотим передать 

    let localisedString = String.init(
        format: NSLocalizedString(
            "label text %@", // На месте %@ появится текст, который мы передадим ниже
            comment: ""
        ), parametrString // Указываем переменную, которую передаем
    )
```

Теперь при выводе `localisedString` мы получим "label text Empty". При локализации можно переносить спецификатор и при выводе на его месте появится информация из переданной нам переменной.

**Можно передавать несколько параметров**

```swift
	let parametrString = "Make Apple"
	let secondParametrString = "great again"
	let parametrInt = 941

	let localisedString = String.init(
        format: NSLocalizedString(
            "label text %@ %@ %d",
            comment: ""
        ), parametrString, secondParametrString, parametrInt // Текст на месте спецификатора появится в том порядке, в каком вы его передадите
    )
```

Если в локализационной строке встетится два одинаковых спецификатора XCode автоматически пронумерует их в экспорте. В локализационном файле это будет выглядеть примерно так:

```swift
"label text %@ %@ %d" = "Lets %1$@ a true %2$@ at %3$d o’clock";
```

Теперь при выводе переменной `localisedString` мы получим следующий текст: Lets Make Apple a true great again at 941 o'clock

Именно для этого мы и передаем переменные в том порядке, в каком хотим видеть их в тексте. Например если сконфигурируем `localisedString` так: 

```swift
    let parametrString = "Make Apple"
    let secondParametrString = "great again"
    let parametrInt = 941

	let localisedString = String.init(
        format: NSLocalizedString(
            "label text %@ %@ %d",
            comment: ""
        ), secondParametrString, parametrString, parametrInt // Меняем parametrString и secondParametrString местами
    )
```

При выводе получим: Lets great again a true Make Apple at 941 o'clock

**Есть разные спецификаторы**

%@ - для значений String;
%d - для значений Int;
%f - для значений Float;
%ld - для значений Long;

Познакомиться с остальными спецификаторами можно на сайте Apple Developer [по ссылке](https://developer.apple.com/library/archive/documentation/Cocoa/Conceptual/Strings/Articles/formatSpecifiers.html).

## Export и import локализации

Переходим в Products и видим две кнопки Export и Import localisations.

[Фотография с расположением кнопок](https://cdn.sparrowcode.io/articles/localisation-ios-apps/products_export_and_import_instruction.png)

Export позволяет вывести локализационные ключи для их дальнейшей локализации. Папка с `xloc` файлами (по файлу на язык) появится в месте, которое вы выберете. Там же можно приступить к локализации.

## Автогенерация

## Плюрализация

## Локализация пакетов

## Локализация значений для валюты, даты и цифр

## Локализация шрифтов и изображений

## Тру-вей в работе с локализациями
